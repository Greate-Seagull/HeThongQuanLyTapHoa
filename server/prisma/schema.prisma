generator client {
  provider = "prisma-client"
  output   = "../src/generated"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model Product {
  id               Int               @id @default(autoincrement())
  name             String?
  unit             ProductUnit       @default(UNKNOWN)
  price            Int
  amount           Int               @default(0)
  promotionDetails PromotionDetail[]
}

model Promotion {
  id               Int               @id @default(autoincrement())
  name             String
  description      String?
  startedAt        DateTime
  endedAt          DateTime
  condition        String?
  value            Float
  promotionType    PromotionType
  promotionDetails PromotionDetail[]
}

model PromotionDetail {
  productId   Int
  promotionId Int
  product     Product   @relation(fields: [productId], references: [id], onDelete: Cascade)
  promotion   Promotion @relation(fields: [promotionId], references: [id], onDelete: Cascade)

  @@id([productId, promotionId])
}

enum PromotionType {
  PERCENTAGE
  FIXED
}

enum ProductUnit {
  UNKNOWN
}
